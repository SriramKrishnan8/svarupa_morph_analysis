import requests
import json

#url = "http://35.165.153.173:5000/sh-wsmp" # OLD
url_wsmp_server = "http://44.243.100.111:5000/sh-wsmp"  # CUR
# url = "http://10.2.62.67:5000/sh-wsmp" # Local

# Word Segmentation and Morphological Parsing
url_wsmp_local = "http://10.2.40.131:5000/sh-wsmp" # Local
params_wsmp = {
    'mantra_index': '1.1.1',
    'mantra': 'अ॒ग्निमी॑ळे पु॒रोहि॑तं य॒ज्ञस्य॑ दे॒वमृ॒त्विज॑म् । होता॑रं रत्न॒धात॑मम् ॥'
#    'mantra': 'ब्रह्म च वा इदम् अग्रे सुब्रह्म चास्ताम्॥' # example for Success
#    'mantra': 'यज्ञो वै देवेभ्य उदक्रामत्तमिष्टिभिः प्रैषमैछन्यदिष्टिभिः प्रैषमैछंस्तदिष्टी-नामिष्टित्वं तमन्वविन्दन्ननुवित्तयज्ञो राध्नोति य एवं वेदाहूतयो वै नामैता यदाहुतय एताभिर्वै देवान्यजमानो ह्वयति तदाहुतीनामाहुतित्वमूतयः खलु वै ता नाम याभिर्देवा यजमानस्य हवमायन्ति ये वै पन्थानो याः स्रुतयस्ता वा ऊतयस्त उ एवैतत्स्वर्गयाणा यजमानस्य भवन्ति तदाहुर्यदन्यो जुहोत्यथ योऽनु चाह यजति च कस्मात्तं होतेत्याचक्षत इति यद्वाव स तत्र यथाभाजनं देवता अमुमावहामुमावहेत्यावाहयति तदेव होतुर्होतृत्वं होता भवति होतेत्येनमाचक्षते य एवं वेद' # example for SH Timeout 504
#    'mantra': 'अग्निर्वै देवानामवमो विष्णुः परमस्तदन्तरेण सर्वा अन्या देवता आग्नावैष्णवम्पुरोळाशं निर्वपन्ति दीक्षणीयमेकादशकपालं सर्वाभ्य एवैनं तद्देवताभ्योऽनन्तरायं निर्वपन्त्यग्निर्वै सर्वा देवता विष्णुः सर्वा देवता एते वै यज्ञस्यान्त्ये तन्वौ यदग्निश्च विष्णुश्च तद्यदाग्नावैष्णवम्पुरोळाशं निर्वपन्त्यन्तत एव तद्देवानृध्नुवन्ति तदाहुर्यदेकादशकपालः पुरोळाशो द्वावग्नाविष्णू कैनयोस्तत्र क्ळ्प्तिः का विभक्तिरित्यष्टाकपाल आग्नेयोऽष्टाक्षरा वै गायत्री गायत्रमग्नेश्छन्दस्त्रिकपालो वैष्णवस्त्रिर्हीदं विष्णुर्व्यक्रमत सैनयोस्तत्र कॢप्तिः सा विभक्तिर्घृते चरुं निर्वपेत योऽप्रतिष्ठितो मन्येतास्यां वाव स न प्रतितिष्ठति यो न प्रतितिष्ठति तद्यद्घृतं तत्स्त्रियै पयो ये तण्डुलास्ते पुंसस्तन्मिथुनम्मि-थुनेनैवैनं तत्प्रजया पशुभिः प्रजनयति प्रजात्यै प्रजायते प्रजया पशुभिर्य एवं वेदारब्धयज्ञो वा एष आरब्धदेवतो यो दर्शपूर्णमासाभ्यां यजत आमावास्येन वा हविषेष्ट्वा पौर्णमासेन वा तस्मिन्नेव हविषि तस्मिन्बर्हिषि दीक्षेतैषो एका दीक्षा सप्तदश सामिधेनीरनुब्रूयात्सप्तदशो वै प्रजापतिर्द्वादश मासाः पञ्चर्तवो हेमन्तशिशिरयोः समासेन तावान्संवत्सरः संवत्सरः प्रजापतिः प्रजाप- त्यायतनाभिरेवाभी राध्नोति य एवं वेद',
#    'mantra': "त्रिषप्ताः", # example for unrecognized
#    'mantra': "agnimMILe purohiwam", # example for input error
#    'mantra': "सासि सुब्रह्मण्ये तस्यास् ते पृथिवी पाद इत्य् आह । यान्य् एव पृथिव्याम् असुररक्षांसि तान्य् एव तेनापहते । सासि सुब्रह्मण्ये तस्यास् ते ऽन्तरिक्षं पाद इत्य् आह । यान्य् एवान्तरिक्षे ऽसुररक्षांसि तान्य् एव तेनापहते । सासि सुब्रह्मण्ये तस्यास् ते द्यौः पाद इत्य् आह । यान्य् एव दिव्य् असुररक्षांसि तान्य् एव तेनापहते । सासि सुब्रह्मण्ये तस्यास् ते दिशः पाद इत्य् आह । यान्य् एव दिक्ष्व् असुररक्षांसि तान्य् एव तेनापहते । परोरजास् ते पञ्चमः पाद इत्य् आह । परं रजसो वै ब्रह्मणः स्थानम् । तद् एतद् आह सा न इषम् ऊर्जं धुक्ष्वेत्य् आह । इषम् एवास्मा ऊर्ज दुग्धे । वीर्यम् अन्नाद्यं धेहीत्य् आह । वीर्यम् एवास्मा अन्नाद्यं दधाति ॥"
#    'mantra': "अथ यदास्य गवां मानुषमहिष्यजाश्वोष्ट्राः प्रसूयन्ते, हीनाङ्गान्य् अतिरिक्ताङ्गानि विकृतरूपाणि वा जायन्ते, असंभवानि संभवन्ति, अचलानि चलन्ति इत्य् एवमादीनि तान्य् एतानि सर्वाणि रुद्रदेवत्यान्य् अद्भुतानि प्रायश्चित्तानि भवन्ति ॥"
#    'mantra': "ता अब्रुवन्न् एता वै किल सर्वा देवताः एकैकाम् एवानु स्मः स यन् नु नः सर्वासां देवतानाम् एका चन न स्यात् तत इदं सर्वम् पराभवेत् ततो न किंचन परिशिष्येत हन्त सार्धं समेत्य यच् छ्रेष्ठं तद् असामेति",
#    'mantra': 'शुषो वाह्नेभ्यो भारद्वाजोऽरालाद्दार्तेयाच्छौनकात्',
}

# Morphological Parsing
url_mp_local = "http://10.2.40.131:5000/sh-mp" # Local
url_mp_server = "http://44.243.100.111:5000/sh-mp" # CUR
params_mp = {
    'term_index' : '1.1.1.1.8',
    'term_text' : 'शतक्रतो इति शतऽक्रतो',
    # 'term_text' : 'ब्रह्म',
    # 'term_text' : 'त्रिऽसप्ताः',
    # 'term_text' : 'त्रिषप्ताः',
    # 'term_text' : 'रत्न॒ऽधात॑मम्',
    # 'term_text' : 'अग्निम्ंः',
    # 'term_text' : 'पुरःऽहितम्',
}

#response = requests.get(url, params=params)
response = requests.post(url_mp_local, json=params_mp)

try:
    data = json.dumps(response.json(), ensure_ascii=False)
    print(data)
except ValueError as e:
    print(f"Failed to parse JSON: {e}")
    print(f"Response content: {response.text}")
    
    
"""
Response for WSMP printed as above:
{"1.1.1.1": {"term_text": "अग्निम्", "term_json_new": [{"name": "अग्निम्", "morphList": [{"name": "अग्निम्", "grammarList": [{"baseElement": "अग्निम्", "stem": "अग्नि", "grammar": "m. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.2": {"term_text": "ईडे", "term_json_new": [{"name": "ईडे", "morphList": [{"name": "ईडे", "grammarList": [{"baseElement": "ईडे", "stem": "", "grammar": "pft. mo. sg. 3", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "ईड्", "selected": false}, {"baseElement": "ईडे", "stem": "", "grammar": "pft. mo. sg. 1", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "ईड्", "selected": false}, {"baseElement": "ईडे", "stem": "", "grammar": "pr. [2] mo. sg. 1", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "ईड्", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.3": {"term_text": "पुरोहितम्", "term_json_new": [{"name": "पुरोहितम्", "morphList": [{"name": "पुरोहितम्", "grammarList": [{"baseElement": "पुरोहितम्", "stem": "पुरस्-हित#2", "grammar": "pp. n. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "पुरस्-धा#1", "selected": false}, {"baseElement": "पुरोहितम्", "stem": "पुरस्-हित#2", "grammar": "pp. n. sg. nom.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "पुरस्-धा#1", "selected": false}, {"baseElement": "पुरोहितम्", "stem": "पुरस्-हित#2", "grammar": "pp. m. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "पुरस्-धा#1", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.4": {"term_text": "यज्ञस्य", "term_json_new": [{"name": "यज्ञस्य", "morphList": [{"name": "यज्ञस्य", "grammarList": [{"baseElement": "यज्ञस्य", "stem": "यज्ञ", "grammar": "m. sg. g.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.5": {"term_text": "देवम्", "term_json_new": [{"name": "देवम्", "morphList": [{"name": "देवम्", "grammarList": [{"baseElement": "देवम्", "stem": "देव", "grammar": "m. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}, {"baseElement": "देवम्", "stem": "देव", "grammar": "n. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}, {"baseElement": "देवम्", "stem": "देव", "grammar": "n. sg. nom.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.6": {"term_text": "ऋत्विजम्", "term_json_new": [{"name": "ऋत्विजम्", "morphList": [{"name": "ऋत्विजम्", "grammarList": [{"baseElement": "ऋत्विजम्", "stem": "ऋत्विज्", "grammar": "m. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.8": {"term_text": "होतारम्", "term_json_new": [{"name": "होतारम्", "morphList": [{"name": "होतारम्", "grammarList": [{"baseElement": "होतारम्", "stem": "होतृ", "grammar": "m. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}, {"baseElement": "होतारम्", "stem": "होतृ", "grammar": "f. sg. acc.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]}, "1.1.1.9": {"term_text": "?रत्नधातमम्", "term_json_new": [{"name": "?रत्नधातमम्", "morphList": [{"name": "?रत्नधातमम्", "grammarList": []}], "selected": false, "source": "SH"}]}}
# Response for MP printed as above:
[{"name": "शतक्रतो", "morphList": [{"name": "शतक्रतो", "grammarList": [{"baseElement": "शतक्रतो", "stem": "शतक्रतु", "grammar": "m. sg. voc. nam.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}, {"name": "शत-क्रतो", "morphList": [{"name": "शत-क्रतो", "grammarList": [{"baseElement": "शत-", "stem": "शत", "grammar": "iic. nam.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}, {"name": "शत-क्रतो", "grammarList": [{"baseElement": "क्रतो", "stem": "क्रतु", "grammar": "m. sg. voc. nam.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}, {"baseElement": "क्रतो", "stem": "क्रतु", "grammar": "f. sg. voc. nam.", "dcsMeaningsStem": null, "ambudaMenaingsStem": null, "dcsMeaningsRoot": null, "ambudaMenaingsRoot": null, "grammarMap": null, "grammarMapEn": null, "grammarMapSa": null, "rootTermLink": null, "root": "", "selected": false}]}], "selected": false, "source": "SH"}]
"""
